local M = {}

local kyria_layout = {
    "  Base Layer: Dvorak_VIM",
    "                          COMBOS                                                            COMBOS",
    "                   , |---   {  ---| p                                                 g |---   }  ---| r   ",
    "                   o |---   (  ---| u                                                 h |---   )  ---| n   ",
    "                   q |---   [  ---| k                                                 m |---   ]  ---| v   ",
    " .-------------------------------------------    COMBO              COMBO    -------------------------------------------.",
    " |  Tab   |  ''  | , <  | . >  |   P  |   Y  |  (. y) => -      (f c) => +  |   F  |   G  |   C  |   R  |   S  |  Bksp  |",
    " |--------+------+------+------+------+------|                              |------+------+------+------+------+--------|",
    " |Ctrl/Esc|   A  |   O  | ↑ E  |   U  |   I  |  (j x) => |      (b w) => =  |   D  |   H  | ↑ T  |   N  |   L  |Ctrl/- _|",
    " |--------+------+------+------+------+------+-------------.  ,-------------+------+------+------+------+------+--------|",
    " |        |  ; : |   Q  |   J  |   K  |   X  | [ {  |CapsLk|  |F-keys|  ] } |   B  |   M  |  W   |   V  |   Z  |        |",
    " `----------------------+------+------+------+------+------|  |------+------+------+------+------+----------------------'",
    "                        (Adjust) LGUI | LAlt | Space| Nav  |  | Sym  | Enter| AltGr| RGUI ( Menu )    COMBO (b z) => close winow",
    "                        `----- `---------------------------'  `--------------------------- ----- '",
    "            Scroll left <== ==> Scroll rigth                                    Scroll up <== ==> Scroll down",
    "",
    "Sym Layer: Numbers, symbols",
    " ,-------------------------------------------.                              ,-------------------------------------------.",
    " |    `   |  !   |  @   |  #   |  $   |  %   |                              |   ^  |  &   |  *   |  (   |  )   | DELETE |",
    " |--------+------+------+------+------+------|                              |------+------+------+------+------+--------|",
    " |    ~   |  1   |  2   |  3   |  4   |  5   |                              |   6  |  7   |  8   |  9   |  0   |   _    |",
    " |--------+------+------+------+------+------+-------------.  ,-------------+------+------+------+------+------+--------|",
    " |        |  ?   |   |  |  |   |  [   |  {   |   (  |      |  |      |  )   |   }  |  ]   |   /  |   =  |  -   |   +    |",
    " `----------------------+------+------+------+------+------|  |------+------+------+------+------+----------------------'",
    "                        (      )      |      |      |      |  | [Sym]|      |      |      (      )",
    "                        `----------------------------------'  `----------------------------------'",
    "            Shift + Tab <== ==> Tab",
    " ",
    "Nav Layer: Media, navigation",
    " ,-------------------------------------------.                              ,-------------------------------------------.",
    " |  MEDIA |M Prev|M Play|M Next|VolMut| BRI+ |                              |BrwsrS| Home | PgDwn| PgUP | END  | Delete |",
    " |--------+------+------+------+------+------|                              |------+------+------+------+------+--------|",
    " |        |      | CUT  | COPY | PASTE| BRI- |                              |BrwsrF|  ←   |   ↓  |  ↑   |  →   | Insert |",
    " |--------+------+------+------+------+------+-------------.  ,-------------+------+------+------+------+------+--------|",
    " |        | Calc |      |MouseW|MouseL|MouseR|Mouse4|Mouse5|  |      |      |BrwsrB|MouseL|MouseD|MouseU|MouseR|  PrtSc |",
    " `----------------------+------+------+------+------+------|  |------+------+------+------+------+----------------------'",
    "                        (      )      |      |      | [Nav]|  |      |      |      |      (      )",
    "                        `----------------------------------'  `----------------------------------'",
    "                                                                                  Vol down <== ==> Vol up",
    " ",
    "Func Layer: F-keys",
    " ,-------------------------------------------.                              ,-------------------------------------------.",
    " |        |  F9  |  F10 |  F11 |  F12 |      |                              |      |      |      |      |      |        |",
    " |--------+------+------+------+------+------|                              |------+------+------+------+------+--------|",
    " |        |  F5  |  F6  |  F7  |  F8  |      |                              |      | SHFT | CTRL | ALT  | SUPER|        |",
    " |--------+------+------+------+------+------+-------------.  ,-------------+------+------+------+------+------+--------|",
    " |        |  F1  |  F2  |  F3  |  F4  |      |      |      |  |[FUNC]|      |      |      |      |      |      |        |",
    " `----------------------+------+------+------+------+------|  |------+------+------+------+------+----------------------'",
    "                        (      )      |      |      |      |  |      |      |      |      (      )",
    "                        `------ ---------------------------'  `----------------------------------'",
    " ",
    "Adjust Layer: Default layer settings, RGB",
    " ,-------------------------------------------.                              ,-------------------------------------------.",
    " |        |      |      |QWERTY|      |      |                              |      |      |      |      |      |        |",
    " |--------+------+------+------+------+------|                              |------+------+------+------+------+--------|",
    " |        |      |      |Dvorak|      |      |                              | TOG  | SAT+ | HUE+ | BRI+ | MOD  |        |",
    " |--------+------+------+------+------+------+-------------.  ,-------------+------+------+------+------+------+--------|",
    " |        |      |      |Colmak|      |      |      |      |  |      |      |      | SAT- | HUE- | BRI- | RMOD |        |",
    " `----------------------+------+------+------+------+------|  |------+------+------+------+------+----------------------'",
    "                        ( [Adj])      |      |      |      |  |      |      |      |      (      )",
    "                        `----------------------------------'  `----------------------------------'",
}

function M.show_kyria()
    local buf = vim.api.nvim_create_buf(false, true)
    vim.api.nvim_buf_set_lines(buf, 0, -1, false, kyria_layout)

    local width = 0
    for _, line in ipairs(kyria_layout) do
        width = math.max(width, #line)
    end
    local height = #kyria_layout

    local opts = {
        style = "minimal",
        relative = "editor",
        width = width + 2,
        height = height,
        row = math.floor((vim.o.lines - height) / 2),
        col = math.floor((vim.o.columns - width) / 2),
        border = "single",
    }
    local win = vim.api.nvim_open_win(buf, true, opts)

    -- Map 'q' to close the window and buffer
    vim.api.nvim_buf_set_keymap(buf, "n", "q", "", {
        nowait = true,
        noremap = true,
        silent = true,
        callback = function()
            vim.api.nvim_win_close(win, true)
            vim.api.nvim_buf_delete(buf, { force = true })
        end,
    })

    -- Optionally, allow closing with <Esc> as well
    vim.api.nvim_buf_set_keymap(buf, "n", "<Esc>", "", {
        nowait = true,
        noremap = true,
        silent = true,
        callback = function()
            vim.api.nvim_win_close(win, true)
            vim.api.nvim_buf_delete(buf, { force = true })
        end,
    })
end

return M
